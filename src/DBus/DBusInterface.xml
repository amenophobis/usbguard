<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE node PUBLIC
  "-//freedesktop//DTD D-Bus Object Introspection 1.0//EN"
  "https://specifications.freedesktop.org/dbus/1.0/introspect.dtd">
<node>
  <interface name="org.usbguard.Policy">
    <method name="listRules">
      <arg name="ruleset" direction="out" type="a(us)"/>
    </method>
    <method name="appendRule">
      <arg name="rule" direction="in" type="s"/>
      <arg name="parent_id" direction="in" type="u"/>
      <arg name="id" direction="out" type="u"/>
    </method>
    <method name="removeRule">
      <arg name="id" direction="in" type="u"/>
    </method>
  </interface>
  <interface name="org.usbguard.Devices">
    <method name="listDevices">
      <arg name="query" direction="in" type="s"/>
      <arg name="devices" direction="out" type="a(us)"/>
    </method>
    <method name="allowDevice">
      <arg name="id" direction="in" type="u"/>
      <arg name="permanent" direction="in" type="b"/>
    </method>
    <method name="blockDevice">
      <arg name="id" direction="in" type="u"/>
      <arg name="permanent" direction="in" type="b"/>
   </method>
    <method name="rejectDevice">
      <arg name="id" direction="in" type="u"/>
      <arg name="permanent" direction="in" type="b"/>
   </method>
    <signal name="DevicePresent">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
      <arg name="interfaces" direction="out" type="as"/>
      <arg name="target" direction="out" type="s"/>
    </signal>
    <signal name="DeviceInserted">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
      <arg name="interfaces" direction="out" type="as"/>
      <arg name="rule_match" direction="out" type="b"/>
      <arg name="rule_id" direction="out" type="u"/>
    </signal>
    <signal name="DeviceRemoved">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
    </signal>
    <signal name="DeviceAllowed">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
      <arg name="rule_match" direction="out" type="b"/>
      <arg name="rule_id" direction="out" type="u"/>
    </signal>
    <signal name="DeviceBlocked">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
      <arg name="rule_match" direction="out" type="b"/>
      <arg name="rule_id" direction="out" type="u"/>
    </signal>
    <signal name="DeviceRejected">
      <arg name="id" direction="out" type="u"/>
      <arg name="attributes" direction="out" type="a{ss}"/>
      <arg name="rule_match" direction="out" type="b"/>
      <arg name="rule_id" direction="out" type="u"/>
    </signal>
  </interface>
</node>
